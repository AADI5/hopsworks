
<div ng-controller="MainCtrl as mainCtrl">
  <div ng-include="'nav.html'"></div>
</div>

<div class="overlay"></div>

<div ng-include="'navProject.html'"></div>

<section>
  <div class="content-wrapper">
    <h3 id="projectBread" style="display: none;"> {{ projectCtrl.currentProject.projectName}} Settings</h3>

    <div ng-controller="ProjectCtrl as projectCtrl">
      <h2>Project settings</h2>


      <form role="form" name="projectForm" ng-submit="projectCtrl.saveProject()">
        <div id="updateSettings">

          <div class="row">

            <div class="col-md-7">
              <fieldset>
                <div class="control-group col-md-offset-1">
                  <label class="control-label">Name</label>
                  <div class="controls">
                    <input class="form-control" name="project_name"
                           type="text"
                           id="projectname"
                           ng-model="projectCtrl.currentProject.projectName"
                           disabled>
                  </div>
                  <p></p>
                  <label class="control-label">Description</label>
                  <div class="controls">
                    <textarea class="form-control" style="resize:none;"
                              ng-model="projectCtrl.currentProject.description"
                              rows="3">
                    </textarea>
                  </div>
                  <p></p>
                  <label class="control-label">Data Retention Period</label>
                  <div class='input-group date col-md-8' id='schedulePicker'>
                    <input id="dpInput" type="text" ng-model="projectCtrl.currentProject.retentionPeriod" data-format="yyyy-MM-dd" class="form-control">
                    <span class="input-group-addon">
                      <span class="glyphicon glyphicon-calendar"></span>
                    </span>
                  </div>
                  <script type="text/javascript">
                        $(function () {
                          $('#schedulePicker').datetimepicker({
                            format: 'YYYY-MM-DD'
                          }).on('dp.change', function (e) {
                            $('#dpInput').trigger('input');
                          });
                        });</script>

                  <p></p>
                </div>
              </fieldset>
            </div>

            <div class="col-md-5">
              <label class="text-muted">Status</label>
              <div class="row" style="margin-left:15px; margin-bottom:0px">
                <fieldset>
                  <span style="margin-top: 40px; margin-left:10px; margin-bottom:0px">
                    {{projectSettingsCtrl.hdfsUsage()}} of {{projectSettingsCtrl.hdfsQuota()}} used
                  </span>          
                </fieldset>
              </div>
              <div class="row" style="margin-top: 10px; margin-left:15px; margin-bottom:0px">
                <fieldset>
                  <span style="margin-top: 40px; margin-left:10px; margin-bottom:0px">
                    {{projectSettingsCtrl.hdfsNsCount()}} files of {{projectSettingsCtrl.hdfsNsQuota()}} used
                  </span>          
                </fieldset>
              </div>
              <div class="row" style="margin-top: 10px; margin-left:15px; margin-bottom:10px">
                <fieldset>
                  <span style="margin-top: 40px; margin-left:10px; margin-bottom:0px">
                    {{projectSettingsCtrl.yarnQuota()}} CPU 
                  </span>          
                </fieldset>    
              </div>

              <fieldset>
                <label class="text-muted" ng-show="projectCtrl.allServicesSelected()">Services</label>
                <div class="control-group col-md-offset-2">
                  <div class="row" ng-repeat="projectType in projectCtrl.projectTypes">
                    <md-checkbox class=" row md-primary" ng-click="projectCtrl.exists(projectType)">
                      {{ projectType}}
                    </md-checkbox>
                  </div>
                </div>
              </fieldset>
            </div>

          </div>

          <div >
            <button class="btn btn-default" type="button" ng-click="projectCtrl.close()">Cancel</button>
            <button class="btn btn-primary" type="submit" 
                    ng-disabled="projectCtrl.working">
              <i ng-if="projectCtrl.working" style="margin-top: 2px" class="fa fa-spinner fa-spin pull-right" ></i>
              Save
            </button>
          </div>
      </form>

    </div>


    <div ng-controller="PythonDepsCtrl as pythonDepsCtrl">

      <div id="wrapper" class="toggled">
        <div class="overlay"></div>

        <div ng-include="'navProject.html'"></div>

        <section>
          <div class="content-wrapper">
            <div growl reference="10" class="pull-right" ></div>


            <div>
              <form class="form-horizontal">
                <div class="form-group"  style="margin-left: 15px;">
                  <div class="row"/>
                  <div class="row">

                    <ul class="nav nav-tabs">
                      <li ng-class="{'active' : pythonDepsCtrl.showClusters === 1}"><a ng-click="pythonDepsCtrl.showTab(false)">Training</a></li>
                      <li ng-class="{'active' : pythonDepsCtrl.showServing === 1}"><a ng-click="pythonDepsCtrl.showTab(true)">Serving</a></li>
                    </ul>                

                  </div>
                  <div class="row"><br></div>

                  <div ng-show="pythonDepsCtrl.advanced === 1">
                    <br>
                    <div class="col-sm-2">
                    </div>
                  </div>              
                </div>
              </form>

              <div ng-show="pythonDepsCtrl.showClusters === 1">

                <button ng-click="accordion.expandAll()">Expand all</button>
                <button ng-click="accordion.collapseAll()">Collapse all</button>

                <v-accordion class="vAccordion--default" multiple>

                  <v-pane ng-repeat="cluster in pythonDepsCtrl.clusters" expanded="cluster.isExpanded" control="accordion">
                    <v-pane-header>
                      {{ ::cluster.name}} 
                      <div class="btn-group pull-right" style="bottom: 10px;" role="group">
                        <button 
                          uib-tooltip="Delete"
                          ng-click="pythonDepsCtrl.toggle(cluster, $index); pythonDepsCtrl.removeCluster(cluster.name); $event.stopPropagation();"
                          type="button" class="btn btn-danger glyphicon glyphicon-trash">                                       
                        </button>
                      </div>
                    </v-pane-header>
                    <v-pane-content>
                      <v-accordion ng-if="cluster.jobs">
                        <v-pane ng-repeat="job in cluster.jobs"">
                          <v-pane-header> 
                            {{ ::job.name}}
                          </v-pane-header>
                          <v-pane-content>
                            {{ ::job.program}}
                            <div class="btn-group pull-right" style="bottom: 10px;" role="group">
                              <button 
                                uib-tooltip="Delete"
                                ng-click="pythonDepsCtrl.toggle(cluster, $index); pythonDepsCtrl.removeJob(cluster.name); $event.stopPropagation();"
                                type="button" class="btn btn-danger glyphicon glyphicon-trash">                                       
                              </button>
                            </div>
                            <v-accordion ng-if="job.tasks">
                              <v-pane ng-repeat="task in job.tasks"">
                                <v-pane-header> 
                                  {{ ::task.host}}
                                </v-pane-header>
                                <v-pane-content>
                                  {{ ::task.params}}
                                </v-pane-content>
                              </v-pane>

                          </v-pane-content>
                        </v-pane>
                      </v-accordion>
                    </v-pane-content>
                  </v-pane> 
                </v-accordion> 



              </div>      
              <div ng-show="pythonDepsCtrl.showServing == 1">
                <br>
                Some stuff here
              </div>
            </div>              
        </section>
      </div>

    </div>
  </div>
</div>

</section>